<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FITHSCS Mobile App - Test Reports Dashboard</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to your external CSS file -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- Dashboard Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="brand-section">
                    <div class="logo-container">
                        <!-- Animated Logo - Representing Logistic Movement -->
                        <div class="logo-icon">
                            <div class="delivery-icon">
                                <div class="package-box"></div>
                                <div class="delivery-path"></div>
                            </div>
                        </div>
                        <div class="brand-info">
                            <h1 class="brand-title">FITHSCS Mobile App</h1>
                            <p class="brand-subtitle">Professional Test Reports Dashboard</p>
                        </div>
                    </div>
                </div>
                <div class="header-meta">
                    <span class="status-indicator">
                        <span class="pulse-dot"></span> CI/CD Status: Online
                    </span>
                    <span id="last-updated" class="text-muted text-sm">Last updated: -</span>
                </div>
            </div>
        </header>

        <!-- Main Dashboard Content Area -->
        <main class="dashboard-main">
            <!-- Loading State -->
            <div id="loading" class="loading-container">
                <div class="loading-spinner"></div>
                <div class="loading-text">Analyzing delivery routes and test reports...</div>
            </div>
            
            <!-- Error State -->
            <div id="error" class="error-container hidden">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h2 class="error-title">Unable to Access Delivery Data</h2>
                <p class="error-message">
                    The system encountered an issue fetching test reports.
                    <br>Please ensure `index.json` is available and accessible. Retrying in 30 seconds...
                </p>
            </div>
            
            <!-- Dashboard Sections (hidden by default, shown by JS) -->
            <div id="dashboard" class="hidden">
                <!-- KPI Statistics Section -->
                <section class="kpi-section">
                    <div class="section-header">
                        <h2>Key Performance Indicators</h2>
                        <p class="section-subtitle">Real-time insights into test pipeline health and efficiency.</p>
                    </div>
                    <div class="kpi-grid">
                        <div class="kpi-card primary">
                            <div class="kpi-header">
                                <div class="kpi-icon delivery-success">
                                    <div class="check-animation"></div>
                                </div>
                                <div class="kpi-trend positive" id="success-trend-kpi">
                                    <!-- Trend will be injected here -->
                                </div>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value" id="total-runs">0</div>
                                <div class="kpi-label">Total Delivery Runs</div>
                                <div class="kpi-subtitle">Completed CI/CD cycles</div>
                            </div>
                        </div>
                        
                        <div class="kpi-card secondary">
                            <div class="kpi-header">
                                <div class="kpi-icon deployment-speed">
                                    <div class="speed-rings">
                                        <div class="ring ring-1"></div>
                                        <div class="ring ring-2"></div>
                                        <div class="ring ring-3"></div>
                                    </div>
                                </div>
                                <div class="kpi-trend stable" id="branches-trend-kpi">
                                    <!-- Trend will be injected here -->
                                </div>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value" id="total-branches">0</div>
                                <div class="kpi-label">Active Delivery Hubs</div>
                                <div class="kpi-subtitle">Distinct branches in action</div>
                            </div>
                        </div>
                        
                        <div class="kpi-card tertiary">
                            <div class="kpi-header">
                                <div class="kpi-icon branch-network">
                                    <div class="network-nodes">
                                        <div class="node main-node"></div>
                                        <div class="node branch-node"></div>
                                        <div class="node branch-node"></div>
                                        <div class="connection-line"></div>
                                    </div>
                                </div>
                                <div class="kpi-trend positive" id="rate-trend-kpi">
                                    <!-- Trend will be injected here -->
                                </div>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value" id="success-rate">0%</div>
                                <div class="kpi-label">Successful Deliveries</div>
                                <div class="kpi-subtitle">Overall test success rate</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Deployment Status Overview -->
                <section class="deployment-status-section">
                    <div class="section-header">
                        <h2>Deployment Readiness</h2>
                        <p class="section-subtitle">Real-time status of critical release branches.</p>
                    </div>
                    <div id="deployment-overview-cards" class="kpi-grid">
                        <!-- Deployment status cards will be rendered here -->
                    </div>

                    <div class="timeline-header mt-6">
                        <h3>Delivery Flow Timeline</h3>
                    </div>
                    <div class="timeline-track">
                        <!-- Animated timeline representing successful deliveries -->
                        <svg class="delivery-truck-svg" viewBox="0 0 100 20" preserveAspectRatio="xMidYMid meet">
                            <path class="road-line" d="M0 10 L100 10" stroke="#374151" stroke-width="1"></path>
                            <circle class="truck-wheel" cx="15" cy="10" r="3" fill="#60a5fa"></circle>
                            <circle class="truck-wheel" cx="85" cy="10" r="3" fill="#60a5fa"></circle>
                            <rect class="truck-body" x="10" y="5" width="80" height="10" rx="2" fill="#2563eb"></rect>
                            <polyline class="truck-roof" points="10,5 20,0 80,0 90,5" fill="#1e40af"></polyline>
                            <circle class="package-bubble" cx="50" cy="10" r="4" fill="#10b981" stroke="#fff" stroke-width="0.5"></circle>
                        </svg>
                    </div>
                </section>

                <!-- Advanced Filters & Search -->
                <section class="card mb-6">
                    <div class="card-header">
                        <h2 class="chart-title">üîç Trace & Filter Deliveries</h2>
                    </div>
                    <div class="card-body">
                        <div class="grid grid-cols-4 gap-4 mb-4">
                            <input type="text" id="search-input" placeholder="Search branch, commit, or test..." class="form-input" />
                            <select id="status-filter" class="form-select">
                                <option value="">All Status</option>
                                <option value="success">‚úÖ Success</option>
                                <option value="failed">‚ùå Failed</option>
                                <option value="warning">‚ö†Ô∏è Warning</option>
                            </select>
                            <input type="date" id="start-date" class="form-input" />
                            <input type="date" id="end-date" class="form-input" />
                        </div>
                        <div class="flex gap-2 mb-2">
                            <button id="filter-apply" class="chart-toggle">Apply Filters</button>
                            <button id="filter-reset" class="chart-toggle">Reset</button>
                            <select id="sort-order" class="form-select">
                                <option value="date-desc">Sort by Date ‚Üì</option>
                                <option value="date-asc">Sort by Date ‚Üë</option>
                                <option value="success-rate-desc">Success Rate ‚Üì</option>
                                <option value="success-rate-asc">Success Rate ‚Üë</option>
                                <option value="coverage-desc">Coverage ‚Üì</option>
                                <option value="coverage-asc">Coverage ‚Üë</option>
                            </select>
                        </div>
                        <div class="flex gap-2">
                            <button class="chart-toggle" onclick="applyPreset('failed')">Failed Deliveries Only</button>
                            <button class="chart-toggle" onclick="applyPreset('low-coverage')">Critical Path Unverified</button>
                            <button class="chart-toggle" onclick="applyPreset('recent')">Recent Activities</button>
                        </div>
                    </div>
                </section>

                <!-- Success Rate Trend Chart -->
                <section class="charts-section">
                    <div class="card-header">
                        <div class="chart-header">
                            <h2 class="chart-title">üìà Delivery Success Rate Trends</h2>
                            <div class="chart-controls">
                                <button class="chart-toggle active" data-period="7d">7 Days</button>
                                <button class="chart-toggle" data-period="30d">30 Days</button>
                                <button class="chart-toggle" data-period="90d">90 Days</button>
                            </div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <svg class="svg-chart" id="success-trend-chart">
                            <!-- Chart will be generated by JavaScript -->
                        </svg>
                    </div>
                </section>

                <!-- Coverage Visualization Grid -->
                <section class="charts-section">
                    <div class="card-header">
                        <h2 class="chart-title">üì¶ Package Coverage Metrics</h2>
                    </div>
                    <div class="coverage-grid" id="coverage-grid">
                        <!-- Coverage cards will be generated by JavaScript -->
                    </div>
                </section>

                <!-- Branch Performance Section -->
                <section class="charts-section">
                    <div class="card-header">
                        <h2 class="chart-title">üöö Delivery Hub Performance</h2>
                    </div>
                    <div class="branch-performance" id="branch-performance">
                        <!-- Performance cards will be generated by JavaScript -->
                    </div>
                </section>

                <!-- Template for Branch Detail Expansion (Hidden by default) -->
                <div class="branch-detail-template hidden" id="branch-details-template">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h3 class="text-lg font-semibold">Test Runs for <span id="branch-detail-name"></span></h3>
                        </div>
                        <div class="card-body" id="branch-detail-body">
                            <div class="branch-loading text-muted">Loading test runs...</div>
                            <table class="w-full text-sm hidden">
                                <thead>
                                    <tr>
                                        <th class="text-left p-2">Run #</th>
                                        <th class="text-left p-2">Status</th>
                                        <th class="text-left p-2">Date</th>
                                        <th class="text-left p-2">Duration</th>
                                        <th class="text-left p-2">Error (if any)</th>
                                    </tr>
                                </thead>
                                <tbody id="branch-run-list">
                                    <!-- Individual runs for this branch will be populated via JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="chart-toggle fixed-button top-button">
        ‚Üë Top
    </button>

    <script src="dashboard.js"></script> <!-- Link to your external JavaScript file -->
</body>
</html>
